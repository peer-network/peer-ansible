# ==================================================
# FILE: playbooks/make_rotate_ssh_keys.yml
# Playbook to add gererated ssh keys to the vms
# ==================================================
# - name: Add ssh keys to all vm for acces
#   hosts: peer-staging-bastion
#   gather_facts: no
#   # gather_facts: yes
#   become: yes

#   # vars_files:
#   #    - host_vars/peer-prod-database.yml   # use '.passcode' to unlock ^IdLW...
#   #    - group_vars/all.yml

#   # playbooks/test_mappings.yml

#   tasks:
# playbooks/verify_hostname_changes.yml
---
- name: Verify hostname changes needed
  hosts: all
  gather_facts: yes
  become: no
  
  tasks:
    - name: Show current vs desired hostnames
      debug:
        msg:
          - "Inventory name: {{ inventory_hostname }}"
          - "Current hostname: {{ ansible_hostname }}"
          - "Current FQDN: {{ ansible_fqdn }}"
          - "Environment: {{ peer_env }}"
          - "Role: {{ role }}"
          - "Change needed: {{ inventory_hostname != ansible_hostname }}"
      
    - name: Create summary of changes
      set_fact:
        hostname_change_summary:
          inventory_name: "{{ inventory_hostname }}"
          current_hostname: "{{ ansible_hostname }}"
          needs_change: "{{ inventory_hostname != ansible_hostname }}"
      
    - name: Display change summary
      debug:
        var: hostname_change_summary


